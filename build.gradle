apply plugin: 'java'
apply plugin: 'war'

sourceCompatibility = '1.8'

repositories {
    mavenCentral()
}

dependencies {
	providedCompile 'javax:javaee-web-api:7.0'

	providedRuntime 'fish.payara.extras:payara-microprofile:1.0-4.1.2.172'
    testCompile 'junit:junit:4.10'
}

war {
	archiveName = 'ROOT.war'
}
task runMicro(type: Exec, dependsOn: war) {
    def payaraJarPath = configurations
                        .providedRuntime
                        .find {it.name =~ /payara-micro.*\.jar/}
                        .absolutePath
    def warFile = war.archivePath
    commandLine('java', '-jar', payaraJarPath, '--deploy', warFile)
}